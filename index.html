<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Author: Oakwin -->
    <!-- Description: A web application for guessing Pok√©mon based on their types -->
    <!-- Keywords: Pok√©mon, guessing game, types -->
    <!-- Date Created: 04-08-2025-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BST Guesser</title>
    <!-- Add favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="./4408299.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./4408299.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./4408299.png">


    <!-- Preload critical resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" as="style">
    <link rel="dns-prefetch" href="//pokeapi.co">
    <link rel="preconnect" href="https://pokeapi.co" crossorigin>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2677128924988240"
     crossorigin="anonymous"></script>
    
    
    <script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                var filteredData = jsonData.filter(row => row.some(filledCell));
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
    </script>
    
    <!-- script tags -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <meta name="google-adsense-account" content="ca-pub-2677128924988240">
    
    <!-- Use alternative Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0f1729 !important; /* Darker, more faded blue background */
            color: white !important; /* ovveride for dark text I need this and not certain why*/
            display: flex;
            flex-direction: column;
        }
        canvas {
            max-width: 100% !important;
            width: 100% !important;
            margin: 0 auto;
            height: 250px !important; /* Smaller height for mobile */
        }
        #pokemonSprite {
            max-width: 250px !important;
            width: 250px !important;
            height: auto;
            margin-bottom: 1rem;
            display: block;
            /* Disable right-click context menu so cheaters cant cheat with open image in new tab */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            pointer-events: none; /* Prevents any mouse interactions */
        }
        /* Re-enable pointer events when image is revealed */
        #pokemonSprite:not(.blurred-grey) {
            pointer-events: auto;
        }
        .blurred-grey {
            filter: blur(30px) grayscale(100%); /* Changed from 35px to 30px */
        }
        #statChart {
            display: block;
            margin-left: auto;
            margin-right: auto;
            max-width: 100%;
        }
        /* Override any dark text */
        p, h1, h2, h3, label, summary {
            color: white !important;
        }
        /* footer as static at bottom */
        footer {
            background-color: #1e40af !important;
            margin-top: auto;
            position: relative;
            bottom: 0;
            width: 100%;
            min-height: 250px; /* Set a minimum height for the footer */
            flex-shrink: 0; /* Prevent footer from shrinking */
        }
        /* Center main title with cute border */
        .main-title {
            text-align: center;
            font-weight: 700;
            letter-spacing: -0.025em;
            border: 3px solid #60a5fa;
            border-radius: 12px;
            padding: 16px 24px;
            background: linear-gradient(135deg, rgba(96, 165, 250, 0.1), rgba(147, 197, 253, 0.1));
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
            display: inline-block;
        }
        /* Main content wrapper */
        .main-content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 250px); /* Reserve space for footer */
            width: 100%;
            padding: 20px 0; /* Add some padding */
        }

        /* centre it */
        #homeMenu {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        /* centre it */
        #gameScreen {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px 16px;
        }

        /* input styling */
        #guessInput {
            color: black !important;
            background-color: white !important;
        }

        /*  */
        #pokemon-list option {
            color: black;
            background-color: white;
        }

        /* loading spinner */
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #60a5fa;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }

        /* buttons  */
        button {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important;
            transition: box-shadow 0.2s ease !important;
        }

        /* on hover */
        button:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4) !important;
        }

        /* Pressed state */
        button:active {
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
        }

        /* Results styling */
        .results-container {
            background: linear-gradient(135deg, rgba(96, 165, 250, 0.1), rgba(147, 197, 253, 0.1));
            border: 2px solid #60a5fa;
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            text-align: center;
        }

        .score-display {
            font-size: 2rem;
            font-weight: bold;
            color: #10b981;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .rank-display {
            font-size: 1.2rem;
            color: #fbbf24;
            margin: 8px 0;
        }

        
        canvas {
            max-width: 100% !important;
            width: 100% !important;
            margin: 0 auto;
            height: 250px !important; /* Smaller height for mobile */
        }

        
        #gameScreen {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px 16px;
        }

        /* Responsive flex layout */
        .flex.flex-col.lg\\:flex-row {
            flex-direction: column !important;
            gap: 16px;
        }

        /* Mobile button adjustments */
        @media (max-width: 768px) {
            /* Stack buttons vertically on small screens */
            .flex.flex-row.items-center.justify-center.space-x-2 {
                flex-direction: column !important;
                gap: 8px !important;
                width: 100%;
            }
            
            .flex.flex-row.items-center.justify-center.space-x-2 > button {
                width: 100% !important;
                max-width: 200px;
            }
            
            /* Mobile-specific button order - Submit first, then Menu */
            .flex.flex-col.sm\\:flex-row .bg-blue-500 {
                order: 1; /* Submit Guess button first */
            }
            
            .flex.flex-col.sm\\:flex-row .bg-gray-500 {
                order: 2; /* Return to Menu button second */
            }
            
            .flex.flex-col.sm\\:flex-row .bg-green-500 {
                order: 3; /* Next Pok√©mon button third */
            }
            
            .flex.flex-col.sm\\:flex-row .bg-red-500 {
                order: 4; /* Restart Challenge button fourth */
            }
            
            /* Smaller buttons container */
            .flex.flex-row.items-center.justify-center.space-x-3 {
                flex-direction: row !important;
                gap: 12px !important;
                width: 100%;
                justify-content: center;
            }
            
            /* Canvas adjustments for mobile */
            canvas {
                height: 200px !important;
                max-width: 350px !important;
            }
            
            /* Pokemon sprite adjustments */
            #pokemonSprite {
                max-width: 250px !important;
                width: 250px !important;
            }
            
            /* Input field adjustments */
            #guessInput {
                width: 100% !important;
                max-width: 300px;
            }
            
            /* Title adjustments */
            .main-title {
                font-size: 1.5rem !important;
                padding: 12px 16px !important;
            }
            
            /* Hints text smaller on mobile */
            #hints p {
                font-size: 0.9rem !important;
            }
        }

        
        .flex.flex-col.lg\\:flex-row.items-center.justify-center {
            width: 100%;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        
        #statChart {
            display: block;
            margin: 0 auto;
            max-width: 100%;
        }

        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .logo-image {
            width: 64px;
            height: 64px;
            object-fit: contain;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
        }

        /* Mobile logo adjustments */
        @media (max-width: 768px) {
            .logo-image {
                width: 48px;
                height: 48px;
            }
            
            .logo-container {
                gap: 12px;
                margin-bottom: 16px;
            }
            
            .logo-container .main-title {
                font-size: 1.8rem !important;
            }
        }

        
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60vh; /* Ensure minimum content height */
        }

        footer {
            margin-top: auto;
            flex-shrink: 0;
        }

        
#languageSelect {
    background: linear-gradient(135deg, #1e40af, #3b82f6);
    border: 1px solid #60a5fa;
    color: white;
    font-size: 0.875rem;
    padding: 4px 8px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
}

#languageSelect:hover {
    background: linear-gradient(135deg, #1d4ed8, #2563eb);
    border-color: #93c5fd;
}

#languageSelect:focus {
    outline: none;
    ring: 2px;
    ring-color: #60a5fa;
    ring-opacity: 0.5;
}

#languageSelect option {
    background-color: #1e40af;
    color: white;
    padding: 4px;
}


@media (max-width: 768px) {
    .flex.flex-col.md\\:flex-row.justify-between.items-center.mb-6 {
        flex-direction: column !important;
        text-align: center;
    }
    
    .flex.items-center.space-x-4.mb-4.md\\:mb-0 {
        flex-wrap: wrap;
        justify-content: center;
        gap: 8px;
        margin-bottom: 16px !important;
    }
    
    .flex.items-center.space-x-2.ml-4 {
        margin-left: 0 !important;
        margin-top: 8px;
        justify-content: center;
    }
    
    #languageSelect {
        font-size: 0.8rem;
        padding: 3px 6px;
    }
}
    </style>
</head>
<body style="background-color: #0f1729;">
    <div class="main-content">
        <div id="homeMenu" class="flex flex-col items-center justify-center space-y-4 mx-auto">
            <h1 class="main-title text-4xl font-bold mb-6 text-white">
                <img src="./4408299.png" alt="BST Guesser Logo" class="w-16 h-16 object-contain"> 
                <span data-translate="title">BST Guesser</span>
            </h1>
            
            <div class="flex items-center space-x-4">
                <label for="fullyEvolvedToggle" class="text-lg font-semibold" data-translate="fullyEvolved">Only Fully Evolved Pok√©mon</label>
                <input id="fullyEvolvedToggle" type="checkbox" class="h-5 w-5">
            </div>
            
            <button id="dailyChallengeButton" class="bg-blue-500 text-white px-6 py-3 rounded hover:bg-blue-600 text-lg" data-translate="dailyChallenge">Daily Challenge</button>
            <button id="infiniteModeButton" class="bg-purple-500 text-white px-6 py-3 rounded hover:bg-purple-600 text-lg" data-translate="infiniteQuiz">Infinite Quiz</button>
        </div>
        
        <!-- loading screen -->
        <div id="loadingScreen" class="hidden loading-container">
            <div class="loading-spinner"></div>
            <p id="loadingText" class="text-lg text-white">Loading Pok√©mon...</p>
            <div class="w-64 bg-gray-200 rounded-full h-2 mt-4">
                <div id="loadingProgress" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>
        
        <div id="gameScreen" class="hidden flex flex-col items-center justify-center w-full mx-auto">
            <h1 id="gameTitle" class="main-title text-3xl font-bold mb-4 mx-auto text-white text-center"></h1>
            <div class="mb-4 mx-auto">
                <p id="guesses" class="text-lg text-center font-semibold">Total Guesses: 0</p>
                <p id="progress" class="text-lg text-center font-semibold">Pok√©mon: 1/5</p>
            </div>
            <div class="flex flex-col lg:flex-row items-center justify-center w-full max-w-4xl mx-auto px-4">
                <div class="flex flex-col items-center w-full">
                    <img id="pokemonSprite" alt="Pok√©mon Sprite" class="blurred-grey mx-auto" />
                    <!-- hints section below the sprite -->
                    <div id="hints" class="text-center mt-4">
                        <p id="typeHint" class="text-lg"><span style="color: #9ca3af;">Type(s): ???</span></p>
                        <p id="abilityHint" class="text-lg"><span style="color: #9ca3af;">Ability: ???</span></p>
                    </div>
                </div>
                <div class="w-full flex justify-center relative">
                    <canvas id="statChart" class="mb-2"></canvas>
                    <!-- Instructions box: smaller, absolutely positioned on large screens -->
                    <div class="hidden lg:block absolute right-0 top-0 translate-x-28 w-56 bg-blue-900 bg-opacity-80 rounded-lg p-3 shadow-lg text-white text-xs">
                        <h2 class="font-bold text-base mb-2">How to Play</h2>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Look at the blurred Pok√©mon sprite and its base stats graph.</li>
                            <li>Type your guess for the Pok√©mon's name below.</li>
                            <li>Hints for type and ability appear after a few incorrect guesses.<span class="font-semibold text-red-300"> <br>( -50 points )</span></li>
                            <li>Click <span class="font-semibold text-orange-300">Skip ( -150 points )</span> to reveal the answer.</li>
                            <li>Use <span class="font-semibold text-indigo-300">Return to Last</span> to go back.</li>
                            <li>Guess as many as you can with fewest guesses and skips!</li>
                        </ul>
                    </div>
                </div>
                <!-- Mobile instructions: below graph, full width, not squished -->
                <div class="block lg:hidden w-full max-w-xs bg-blue-900 bg-opacity-80 rounded-lg p-3 mt-4 shadow-lg text-white text-xs mx-auto">
                    <h2 class="font-bold text-base mb-2">How to Play</h2>
                    <ul class="list-disc list-inside space-y-1">
                        <li>Look at the blurred Pok√©mon sprite and its base stats graph.</li>
                            <li>Type your guess for the Pok√©mon's name below.</li>
                            <li>Hints for type and ability appear after a few incorrect guesses.<span class="font-semibold text-red-300"> ( -50 points )</span></li>
                            <li>Click <span class="font-semibold text-orange-300">Skip ( -150 points )</span> to reveal the answer.</li>
                            <li>Use <span class="font-semibold text-indigo-300">Return to Last</span> to go back.</li>
                            <li>Guess as many as you can with fewest guesses and skips!</li>
                    </ul>
                </div>
            </div>
            <div class="flex flex-col items-center justify-center space-y-4 mx-auto w-full px-4">
                <!-- Move message above the input box -->
                <p id="message" class="text-lg text-center font-semibold">Guess the Pok√©mon!</p>
                
                <input id="guessInput" type="text" placeholder="Enter Pok√©mon name" class="border p-2 rounded w-64" list="pokemon-list">
                <datalist id="pokemon-list">
                    <!-- Options will be added by JavaScript -->
                </datalist>
                <div class="flex flex-col sm:flex-row items-center justify-center gap-2 mt-2 w-full">
                    <button id="returnToMenuButton" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 w-full sm:w-auto">Return to Menu</button>
                    <button id="nextButton" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 hidden w-full sm:w-auto">Next Pok√©mon</button>
                    <button id="restartButton" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 hidden w-full sm:w-auto">Restart Challenge</button>
                    <button id="guessButton" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 w-full sm:w-auto">Submit Guess</button>
                </div>
                <!-- Add smaller buttons underneath -->
                <div class="flex flex-row items-center justify-center space-x-3 mt-2">
                    <button id="previousButton" class="bg-indigo-500 text-white px-3 py-1 rounded hover:bg-indigo-600 text-sm hidden">Return to Last</button>
                    <button id="skipButton" class="bg-orange-500 text-white px-3 py-1 rounded hover:bg-orange-600 text-sm">Skip</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
// Game variables
let currentPokemon = null;
let pokemonQueue = [];
let currentPokemonIndex = 0;
let totalGuesses = 0;
let totalSkips = 0; // Add skip tracking variable
let currentBlur = 30; // Changed from 35 to 30
let myChart = null;
let gameMode = '';
let incorrectGuesses = 0;

// DOM elements
const dailyChallengeButton = document.getElementById('dailyChallengeButton');
const infiniteModeButton = document.getElementById('infiniteModeButton');
const homeMenu = document.getElementById('homeMenu');
const gameScreen = document.getElementById('gameScreen');
const gameTitle = document.getElementById('gameTitle');
const returnToMenuButton = document.getElementById('returnToMenuButton');
const pokemonSprite = document.getElementById('pokemonSprite');
const statChart = document.getElementById('statChart');
const guessInput = document.getElementById('guessInput');
const guessButton = document.getElementById('guessButton');
const nextButton = document.getElementById('nextButton');
const restartButton = document.getElementById('restartButton');
const message = document.getElementById('message');
const guessesDisplay = document.getElementById('guesses');
const progressDisplay = document.getElementById('progress');
const fullyEvolvedToggle = document.getElementById('fullyEvolvedToggle');
const loadingScreen = document.getElementById('loadingScreen');
const skipButton = document.getElementById('skipButton'); 
const previousButton = document.getElementById('previousButton'); 

// Pokemon names for autocomplete
const allPokemonNames = [];

// Translations
const translations = {
    en: {
        title: "BST Guesser",
        language: "Language:",
        fullyEvolved: "Only Fully Evolved Pok√©mon",
        dailyChallenge: "Daily Challenge",
        infiniteQuiz: "Infinite Quiz",
        loadingPokemon: "Loading Pok√©mon...",
        guessPokemon: "Guess the Pok√©mon!",
        enterPokemonName: "Enter Pok√©mon name",
        totalGuesses: "Total Guesses:",
        pokemon: "Pok√©mon:",
        infiniteMode: "Infinite Mode",
        returnToMenu: "Return to Menu",
        nextPokemon: "Next Pok√©mon",
        restartChallenge: "Restart Challenge",
        submitGuess: "Submit Guess",
        skip: "Skip",
        returnToLast: "Return to Last",
        correct: "Correct! It's",
        incorrect: "Incorrect.",
        skipped: "Skipped! It was",
        types: "Type(s):",
        ability: "Ability:",
        dailyChallengeComplete: "Daily Challenge Complete!",
        score: "Score:",
        pokemonMaster: "Pok√©mon Master! ü•á",
        expertTrainer: "Expert Trainer! ü•à",
        skilledTrainer: "Skilled Trainer! ü•â",
        noviceTrainer: "Novice Trainer üìö",
        keepTraining: "Keep Training! üí™",
        shareResults: "üì§ Share Results",
        copied: "‚úÖ Copied!",
        sessionComplete: "Session Complete!",
        pokemonGuessed: "Pok√©mon Guessed:",
        skips: "Skips:",
        guesses: "Guesses:",
        efficiency: "efficiency",
        canYouBeat: "Can you beat my score? Play at:",
        madeWith: "Made with ‚ù§Ô∏è by and for Pok√©mon fans | Data powered by",
        allRightsReserved: "All rights reserved",
        privacyPolicy: "üîí Privacy Policy",
        termsOfService: "üìã Terms of Service",
        privacyText: "This website does not collect personal information. Third-party services (such as ad networks) may use cookies for analytics and advertising. All Pok√©mon data is sourced from Pok√©API.",
        termsText: "By using this site, you agree to use it for entertainment purposes only. All Pok√©mon data is provided by the Pok√©API and is for non-commercial use. Pok√©mon ¬© Nintendo/Game Freak.",
        followTwitter: "Follow on Twitter/X",
        viewGithub: "View on GitHub"
    },
    fr: {
        title: "Devineur BST",
        language: "Langue :",
        fullyEvolved: "Pok√©mon compl√®tement √©volu√©s seulement",
        dailyChallenge: "D√©fi Quotidien",
        infiniteQuiz: "Quiz Infini",
        loadingPokemon: "Chargement des Pok√©mon...",
        guessPokemon: "Devinez le Pok√©mon !",
        enterPokemonName: "Entrez le nom du Pok√©mon",
        totalGuesses: "Total des tentatives :",
        pokemon: "Pok√©mon :",
        infiniteMode: "Mode Infini",
        returnToMenu: "Retour au Menu",
        nextPokemon: "Pok√©mon Suivant",
        restartChallenge: "Red√©marrer le D√©fi",
        submitGuess: "Soumettre",
        skip: "Passer",
        returnToLast: "Retour au Pr√©c√©dent",
        correct: "Correct ! C'est",
        incorrect: "Incorrect.",
        skipped: "Pass√© ! C'√©tait",
        types: "Type(s) :",
        ability: "Capacit√© :",
        dailyChallengeComplete: "D√©fi Quotidien Termin√© !",
        score: "Score :",
        pokemonMaster: "Ma√Ætre Pok√©mon ! ü•á",
        expertTrainer: "Dresseur Expert ! ü•à",
        skilledTrainer: "Dresseur Habile ! ü•â",
        noviceTrainer: "Dresseur Novice üìö",
        keepTraining: "Continuez l'Entra√Ænement ! üí™",
        shareResults: "üì§ Partager les R√©sultats",
        copied: "‚úÖ Copi√© !",
        sessionComplete: "Session Termin√©e !",
        pokemonGuessed: "Pok√©mon Devin√©s :",
        skips: "Pass√©s :",
        guesses: "Tentatives :",
        efficiency: "efficacit√©",
        canYouBeat: "Pouvez-vous battre mon score ? Jouez sur :",
        madeWith: "Fait avec ‚ù§Ô∏è par et pour les fans de Pok√©mon | Donn√©es fournies par",
        allRightsReserved: "Tous droits r√©serv√©s",
        privacyPolicy: "üîí Politique de Confidentialit√©",
        termsOfService: "üìã Conditions d'Utilisation",
        privacyText: "Ce site web ne collecte pas d'informations personnelles. Les services tiers (comme les r√©seaux publicitaires) peuvent utiliser des cookies pour l'analyse et la publicit√©. Toutes les donn√©es Pok√©mon proviennent de Pok√©API.",
        termsText: "En utilisant ce site, vous acceptez de l'utiliser uniquement √† des fins de divertissement. Toutes les donn√©es Pok√©mon sont fournies par Pok√©API et sont destin√©es √† un usage non commercial. Pok√©mon ¬© Nintendo/Game Freak.",
        followTwitter: "Suivre sur Twitter/X",
        viewGithub: "Voir sur GitHub"
    }
};

let currentLanguage = 'en';

// Translation function - WIP
function translate(key) {
    return translations[currentLanguage][key] || translations.en[key] || key;
}

// Update all translatable elements - WIP
function updateLanguage() {
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        element.textContent = translate(key);
    });
    
    // Update placeholders
    const guessInput = document.getElementById('guessInput');
    if (guessInput) {
        guessInput.placeholder = translate('enterPokemonName');
    }
    
    // Update loading text
    const loadingText = document.getElementById('loadingText');
    if (loadingText) {
        loadingText.textContent = translate('loadingPokemon');
    }
    
    // Update tooltips
    document.querySelector('a[title*="Twitter"]')?.setAttribute('title', translate('followTwitter'));
    document.querySelector('a[title*="GitHub"]')?.setAttribute('title', translate('viewGithub'));
}

// Event listeners
dailyChallengeButton.addEventListener('click', () => startGame('daily'));
infiniteModeButton.addEventListener('click', () => startGame('infinite'));
returnToMenuButton.addEventListener('click', returnToMenu);
guessButton.addEventListener('click', checkGuess);
nextButton.addEventListener('click', nextPokemon);
restartButton.addEventListener('click', () => startGame(gameMode));
skipButton.addEventListener('click', skipPokemon); 
previousButton.addEventListener('click', previousPokemon); 

// Enter key support
guessInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        checkGuess();
    }
});

// Initialize autocomplete with full list
async function initializeAutocomplete() {
    try {
        // Load all 1025 Pokemon names for complete autocomplete
        const response = await fetch('https://pokeapi.co/api/v2/pokemon?limit=1025');
        const data = await response.json();
        const datalist = document.getElementById('pokemon-list');
        datalist.innerHTML = "";
        
        // Use DocumentFragment for better performance
        const fragment = document.createDocumentFragment();
        data.results.forEach(p => {
            const name = p.name.charAt(0).toUpperCase() + p.name.slice(1);
            allPokemonNames.push(name.toLowerCase());
            const option = document.createElement('option');
            option.value = name;
            fragment.appendChild(option);
        });
        datalist.appendChild(fragment);
    } catch (error) {
        console.error('Error loading Pokemon names:', error);
    }
}

// Start game
async function startGame(mode) {
    gameMode = mode;
    
    // Remove any existing share button before starting new game
    const existingShareButton = document.querySelector('#gameScreen button[onclick*="generateShareText"]');
    if (existingShareButton) {
        existingShareButton.remove();
    }
    
    // Show loading screen, hide other screens
    homeMenu.classList.add('hidden');
    gameScreen.classList.add('hidden');
    loadingScreen.classList.remove('hidden');
    
    if (mode === 'daily') {
        gameTitle.textContent = 'Daily Challenge';
    } else {
        gameTitle.textContent = 'Infinite Quiz';
    }
    
    // Reset game state
    currentPokemonIndex = 0;
    totalGuesses = 0;
    totalSkips = 0;
    pokemonQueue = [];
    
    try {
        // Generate Pokemon queue
        await generatePokemonQueue();
        
        // Load first Pokemon
        await loadPokemon(0);
        
        // Hide loading screen, show game screen
        loadingScreen.classList.add('hidden');
        gameScreen.classList.remove('hidden');
        
        // Update UI
        guessButton.classList.remove('hidden');
        nextButton.classList.add('hidden');
        restartButton.classList.add('hidden');
        guessesDisplay.textContent = 'Total Guesses: 0';
        progressDisplay.textContent = `Pok√©mon: 1/${pokemonQueue.length}`;
    } catch (error) {
        console.error('Error starting game:', error);
        // Hide loading screen, show home menu on error
        loadingScreen.classList.add('hidden');
        homeMenu.classList.remove('hidden');
    }
}

// Update the generatePokemonQueue function
async function generatePokemonQueue() {
    const onlyFullyEvolved = fullyEvolvedToggle.checked;
    const queueSize = gameMode === 'daily' ? 5 : 10; // Keep 10 for infinite mode initial load
    
    if (gameMode === 'daily') {
        // Daily challenge logic - need to generate more IDs to account for filtering
        const pokemonIds = [];
        const today = new Date().toDateString();
        
        // Generate more IDs to ensure we get enough valid Pok√©mon after filtering
        const idsToGenerate = onlyFullyEvolved ? queueSize * 4 : queueSize * 2; // More IDs for fully evolved
        
        for (let i = 0; i < idsToGenerate; i++) {
            const seed = hashCode(today + i);
            pokemonIds.push((Math.abs(seed) % 1025) + 1);
        }
        
        const promises = pokemonIds.map(id => 
            fetch(`https://pokeapi.co/api/v2/pokemon/${id}`)
                .then(r => r.json())
                .catch(() => null)
        );
        
        const results = await Promise.all(promises);
        const validPokemon = results.filter(p => p !== null);
        
        if (onlyFullyEvolved) {
            const evolutionPromises = validPokemon.map(async pokemon => {
                try {
                    const speciesResponse = await fetch(pokemon.species.url);
                    const species = await speciesResponse.json();
                    const evolutionResponse = await fetch(species.evolution_chain.url);
                    const evolution = await evolutionResponse.json();
                    
                    if (isFullyEvolved(pokemon.name, evolution.chain)) {
                        return pokemon;
                    }
                } catch (error) {
                    console.error('Evolution check error:', error);
                }
                return null;
            });
            
            const evolutionResults = await Promise.all(evolutionPromises);
            const fullyEvolvedPokemon = evolutionResults.filter(p => p !== null);
            pokemonQueue.push(...fullyEvolvedPokemon.slice(0, queueSize));
            
            // If we don't have enough fully evolved Pok√©mon, fill with regular ones
            if (pokemonQueue.length < queueSize) {
                const remaining = queueSize - pokemonQueue.length;
                const regularPokemon = validPokemon.filter(p => 
                    !pokemonQueue.some(existing => existing.id === p.id)
                );
                pokemonQueue.push(...regularPokemon.slice(0, remaining));
            }
        } else {
            pokemonQueue.push(...validPokemon.slice(0, queueSize));
        }
        
        // Ensure we have exactly the right number of Pok√©mon
        if (pokemonQueue.length < queueSize) {
            console.warn(`Only loaded ${pokemonQueue.length} Pok√©mon instead of ${queueSize}`);
            // Could add fallback logic here to load more if needed
        }
    } else {
        // Infinite mode logic (unchanged)
        const batchSize = 5;
        while (pokemonQueue.length < queueSize) {
            const ids = Array.from({length: batchSize}, () => Math.floor(Math.random() * 1025) + 1);
            const promises = ids.map(id => 
                fetch(`https://pokeapi.co/api/v2/pokemon/${id}`)
                    .then(r => r.json())
                    .catch(() => null)
            );
            
            const results = await Promise.all(promises);
            const validPokemon = results.filter(p => p !== null && !pokemonQueue.some(existing => existing.id === p.id));
            
            if (onlyFullyEvolved) {
                for (const pokemon of validPokemon) {
                    if (pokemonQueue.length >= queueSize) break;
                    try {
                        const speciesResponse = await fetch(pokemon.species.url);
                        const species = await speciesResponse.json();
                        const evolutionResponse = await fetch(species.evolution_chain.url);
                        const evolution = await evolutionResponse.json();
                        
                        if (isFullyEvolved(pokemon.name, evolution.chain)) {
                            pokemonQueue.push(pokemon);
                        }
                    } catch (error) {
                        console.error('Evolution check error:', error);
                    }
                }
            } else {
                pokemonQueue.push(...validPokemon.slice(0, queueSize - pokemonQueue.length));
            }
        }
    }
}

// Hash function for daily challenge
function hashCode(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
        const char = str.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
    }
    return hash;
}

// Check if Pokemon is fully evolved
function isFullyEvolved(pokemonName, evolutionChain) {
    function findInChain(chain) {
        if (chain.species.name === pokemonName) {
            return chain.evolves_to.length === 0;
        }
        for (let evolution of chain.evolves_to) {
            const result = findInChain(evolution);
            if (result !== null) return result;
        }
        return null;
    }
    return findInChain(evolutionChain);
}

// Load Pokemon
async function loadPokemon(index) {
    // For infinite mode, make sure we have enough Pokemon loaded ahead
    if (gameMode === 'infinite' && index >= pokemonQueue.length) {
        await loadNextInfinitePokemon();
    }
    
    // Safety check
    if (index >= pokemonQueue.length) {
        if (gameMode === 'daily') {
            endGame();
            return;
        } else {
            console.error('Pokemon not available for infinite mode');
            return;
        }
    }
    
    currentPokemon = pokemonQueue[index];
    incorrectGuesses = 0;
    currentBlur = 30;
    
    // Update sprite
    pokemonSprite.src = currentPokemon.sprites.front_default;
    pokemonSprite.classList.add('blurred-grey');
    pokemonSprite.style.filter = 'blur(30px) grayscale(100%)';
    
    // Create chart
    createChart(currentPokemon.stats, currentPokemon.name);
    
    // Update progress - show different text for infinite mode
    if (gameMode === 'infinite') {
        progressDisplay.textContent = `Pok√©mon: ${index + 1} (Infinite Mode)`;
    } else {
        progressDisplay.textContent = `Pok√©mon: ${index + 1}/${pokemonQueue.length}`;
    }
    
    // Clear input and set initial message and hints
    guessInput.value = '';
    message.textContent = 'Guess the Pok√©mon!';
    document.getElementById('typeHint').innerHTML = '<span style="color: #9ca3af;">Type(s): ???</span>';
    document.getElementById('abilityHint').innerHTML = '<span style="color: #9ca3af;">Ability: ???</span>';
    
    // Reset button states
    skipButton.classList.remove('hidden');
    previousButton.classList.add('hidden');
    
    guessInput.focus();
}

// Create chart with horizontal animation
function createChart(stats, pokemonName) {
    if (myChart) myChart.destroy();
    
    const statLabels = ['HP', 'Attack', 'Defense', 'Sp. Atk', 'Sp. Def', 'Speed'];
    const statValues = stats.map(stat => stat.base_stat);
    const totalStat = statValues.reduce((sum, val) => sum + val, 0);
    const backgroundColors = statValues.map(value => getGradientColor(value));
    const borderColors = statValues.map(value => getGradientColor(value).replace('0.6', '1'));

    // Adjust chart size based on screen width
    const isMobile = window.innerWidth <= 768;
    const barThickness = isMobile ? 20 : 25;
    const fontSize = isMobile ? 10 : 13;

    myChart = new Chart(statChart, {
        type: 'bar',
        data: {
            labels: statLabels,
            datasets: [{
                label: `Base Stat Total: ${totalStat}`,
                data: statValues,
                backgroundColor: backgroundColors,
                borderColor: borderColors,
                borderWidth: 1,
                barThickness: barThickness
            }]
        },
        options: {
            devicePixelRatio: window.devicePixelRatio || 2,
            responsive: true,
            maintainAspectRatio: false,
            indexAxis: 'y',
            animation: {
                duration: 1200,
                easing: 'easeOutQuart',
                x: {
                    from: 0,
                    duration: 1200,
                    easing: 'easeOutQuart'
                }
            },
            scales: {
                x: {
                    beginAtZero: true,
                    max: 255,
                    display: false
                },
                y: {
                    title: {
                        display: false
                    },
                    ticks: {
                        color: '#d1d5db',
                        font: {
                            size: fontSize
                        },
                        padding: 5
                    }
                }
            },
            plugins: {
                legend: {
                    display: true,
                    labels: {
                        color: '#f3f4f6',
                        font: {
                            size: fontSize
                        }
                    }
                },
                datalabels: {
                    anchor: 'end',
                    align: 'end',
                    formatter: (value) => value,
                    color: '#ffffff',
                    font: {
                        weight: 'bold',
                        size: fontSize - 1
                    }
                }
            }
        }});
}

// Get gradient color for stats
function getGradientColor(value) {
    if (value <= 30) return 'rgba(239, 68, 68, 0.6)';
    if (value <= 60) return 'rgba(249, 115, 22, 0.6)';
    if (value <= 90) return 'rgba(245, 158, 11, 0.6)';
    if (value <= 120) return 'rgba(132, 204, 22, 0.6)';
    if (value <= 150) return 'rgba(34, 197, 94, 0.6)';
    return 'rgba(16, 185, 129, 0.6)';
}

// Check guess
function checkGuess() {
    totalGuesses++;
    guessesDisplay.textContent = `Total Guesses: ${totalGuesses}`;
    const guess = guessInput.value.trim().toLowerCase();
    
    if (guess === currentPokemon.name) {
        // Green color for correct answer
        message.innerHTML = `<span style="color: #10b981;">Correct! It's ${currentPokemon.name.charAt(0).toUpperCase() + currentPokemon.name.slice(1)}!</span>`;
        pokemonSprite.classList.remove('blurred-grey');
        pokemonSprite.style.filter = 'none';
        pokemonSprite.style.width = '300px';
        pokemonSprite.style.maxWidth = '300px';
        
        // Update button visibility
        guessButton.classList.add('hidden');
        skipButton.classList.add('hidden');
        nextButton.classList.remove('hidden');
        
        // Show previous button if not on first Pokemon
        if (currentPokemonIndex > 0) {
            previousButton.classList.remove('hidden');
        }
    } else {
        incorrectGuesses++;
        currentBlur = Math.max(currentBlur - 3, 0);
        pokemonSprite.style.filter = `blur(${currentBlur}px) grayscale(100%)`;

        // Get ability and type hints with ability coming after type
        const abilityHint = currentPokemon.abilities[0].ability.name.charAt(0).toUpperCase() + currentPokemon.abilities[0].ability.name.slice(1);
        const typeHint = currentPokemon.types.map(t => t.type.name.charAt(0).toUpperCase() + t.type.name.slice(1)).join(', ');

        // Red color for incorrect answer
        message.innerHTML = `<span style="color: #ef4444;">Incorrect.</span>`;
        
        if (incorrectGuesses === 2) {
            document.getElementById('typeHint').textContent = `Type(s): ${typeHint}`;
        } else if (incorrectGuesses >= 3) {
            document.getElementById('typeHint').textContent = `Type(s): ${typeHint}`;
            document.getElementById('abilityHint').textContent = `Ability: ${abilityHint}`;
        }
    }
    guessInput.value = '';
    guessInput.focus();
}

// Next Pokemon
function nextPokemon() {
    currentPokemonIndex++;
    
    if (gameMode === 'infinite') {
        // For infinite mode, check if we need to load more Pokemon
        if (currentPokemonIndex >= pokemonQueue.length) {
            // Load next Pokemon and then proceed
            loadNextInfinitePokemon().then(() => {
                loadPokemon(currentPokemonIndex);
                resetButtonStates();
            }).catch(error => {
                console.error('Error loading next Pokemon:', error);
                // Fallback: just load what we have
                if (pokemonQueue.length > currentPokemonIndex) {
                    loadPokemon(currentPokemonIndex);
                    resetButtonStates();
                }
            });
        } else {
            // We already have this Pokemon loaded
            loadPokemon(currentPokemonIndex);
            resetButtonStates();
        }
    } else {
        // Daily challenge logic
        if (currentPokemonIndex >= pokemonQueue.length) {
            endGame();
        } else {
            loadPokemon(currentPokemonIndex);
            resetButtonStates();
        }
    }
}

// Skip Pokemon function
function skipPokemon() {
    totalSkips++; // Track skips
    
    // Orange color for skipped Pokemon
    message.innerHTML = `<span style="color: #f97316;">Skipped! It was ${currentPokemon.name.charAt(0).toUpperCase() + currentPokemon.name.slice(1)}!</span>`;
    pokemonSprite.classList.remove('blurred-grey');
    pokemonSprite.style.filter = 'none';
    
    // Reveal all hints
    const abilityHint = currentPokemon.abilities[0].ability.name.charAt(0).toUpperCase() + currentPokemon.abilities[0].ability.name.slice(1);
    const typeHint = currentPokemon.types.map(t => t.type.name.charAt(0).toUpperCase() + t.type.name.slice(1)).join(', ');
    document.getElementById('typeHint').textContent = `Type(s): ${typeHint}`;
    document.getElementById('abilityHint').textContent = `Ability: ${abilityHint}`;
    
    // Hide skip button, show next button
    skipButton.classList.add('hidden');
    guessButton.classList.add('hidden');
    nextButton.classList.remove('hidden');
    
    // Show previous button if not on first Pokemon
    if (currentPokemonIndex > 0) {
        previousButton.classList.remove('hidden');
    }
}

// Previous Pokemon function
function previousPokemon() {
    if (currentPokemonIndex > 0) {
        currentPokemonIndex--;
        loadPokemon(currentPokemonIndex);
        
        // Reset button states
        guessButton.classList.remove('hidden');
        nextButton.classList.add('hidden');
        skipButton.classList.remove('hidden');
        previousButton.classList.add('hidden');
    }
}

// function to load next Pokemon for infinite mode
async function loadNextInfinitePokemon() {
    const onlyFullyEvolved = fullyEvolvedToggle.checked;
    let attempts = 0;
    const maxAttempts = 50;
    
    while (attempts < maxAttempts) {
        try {
            const pokemonId = Math.floor(Math.random() * 1025) + 1;
            const pokemon = await getPokemon(pokemonId);
            
            // Check if we already have this Pokemon in recent history (avoid immediate repeats)
            const recentPokemon = pokemonQueue.slice(-10); // Check last 10
            if (recentPokemon.some(p => p.id === pokemon.id)) {
                attempts++;
                continue;
            }
            
            if (onlyFullyEvolved) {
                const speciesResponse = await fetch(pokemon.species.url);
                const species = await speciesResponse.json();
                const evolutionResponse = await fetch(species.evolution_chain.url);
                const evolution = await evolutionResponse.json();
                
                if (isFullyEvolved(pokemon.name, evolution.chain)) {
                    pokemonQueue.push(pokemon);
                    return;
                }
            } else {
                pokemonQueue.push(pokemon);
                return;
            }
        } catch (error) {
            console.error('Error fetching Pokemon:', error);
        }
        attempts++;
    }
    
    // Fallback - add a random Pokemon without evolution check
    try {
        const pokemonId = Math.floor(Math.random() * 1025) + 1;
        const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemonId}`);
        const pokemon = await response.json();
        pokemonQueue.push(pokemon);
    } catch (error) {
        console.error('Failed to load fallback Pokemon:', error);
    }
}

// Helper function to reset button states
function resetButtonStates() {
    guessButton.classList.remove('hidden');
    nextButton.classList.add('hidden');
    skipButton.classList.remove('hidden');
    
    // Show previous button if not on first Pokemon
    if (currentPokemonIndex > 0) {
        previousButton.classList.remove('hidden');
    }
}

// Update the loadPokemon function to handle infinite mode progress display
async function loadPokemon(index) {
    // For infinite mode, make sure we have enough Pokemon loaded ahead
    if (gameMode === 'infinite' && index >= pokemonQueue.length) {
        await loadNextInfinitePokemon();
    }
    
    // Safety check
    if (index >= pokemonQueue.length) {
        if (gameMode === 'daily') {
            endGame();
            return;
        } else {
            console.error('Pokemon not available for infinite mode');
            return;
        }
    }
    
    currentPokemon = pokemonQueue[index];
    incorrectGuesses = 0;
    currentBlur = 30;
    
    // Update sprite
    pokemonSprite.src = currentPokemon.sprites.front_default;
    pokemonSprite.classList.add('blurred-grey');
    pokemonSprite.style.filter = 'blur(30px) grayscale(100%)';
    
    // Create chart
    createChart(currentPokemon.stats, currentPokemon.name);
    
    // Update progress - show different text for infinite mode
    if (gameMode === 'infinite') {
        progressDisplay.textContent = `Pok√©mon: ${index + 1} (Infinite Mode)`;
    } else {
        progressDisplay.textContent = `Pok√©mon: ${index + 1}/${pokemonQueue.length}`;
    }
    
    // Clear input and set initial message and hints
    guessInput.value = '';
    message.textContent = 'Guess the Pok√©mon!';
    document.getElementById('typeHint').innerHTML = '<span style="color: #9ca3af;">Type(s): ???</span>';
    document.getElementById('abilityHint').innerHTML = '<span style="color: #9ca3af;">Ability: ???</span>';
    
    // Reset button states
    skipButton.classList.remove('hidden');
    previousButton.classList.add('hidden');
    
    guessInput.focus();
}

// End game function
function endGame() {
    if (gameMode === 'daily') {
        const score = calculateScore();
        const rank = getScoreRank(score);
        
        message.innerHTML = `
            <div class="text-center space-y-2">
                <div class="text-xl font-bold text-green-400">Daily Challenge Complete!</div>
                <div class="text-lg">üéØ Score: ${score}/1000</div>
                <div class="text-md">${rank}</div>
                <div class="text-sm text-gray-300">Total Guesses: ${totalGuesses}</div>
                <div class="text-sm text-gray-300">Skips: ${totalSkips}</div>
            </div>
        `;
        
        // Share button logic
        const existingShareButton = document.getElementById('shareResultsButton');
        if (existingShareButton) {
            existingShareButton.remove();
        }
        
        const shareButton = document.createElement('button');
        shareButton.id = 'shareResultsButton';
        shareButton.textContent = 'üì§ Share Results';
        shareButton.className = 'bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mt-4 mb-4';
        shareButton.onclick = async () => {
            const shareText = generateShareText(score);
            const copied = await copyToClipboard(shareText);
            if (copied) {
                shareButton.textContent = '‚úÖ Copied!';
                shareButton.className = 'bg-green-600 text-white px-4 py-2 rounded mt-4 mb-4';
                setTimeout(() => {
                    shareButton.textContent = 'üì§ Share Results';
                    shareButton.className = 'bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mt-4 mb-4';
                }, 2000);
            }
        };
        
        const inputContainer = document.querySelector('#gameScreen .flex.flex-col.items-center.justify-center.space-y-4');
        const messageElement = document.getElementById('message');
        inputContainer.insertBefore(shareButton, messageElement.nextSibling);
        
    } else {
        message.innerHTML = `
            <div class="text-center space-y-2">
                <div class="text-xl font-bold text-blue-400">Session Complete!</div>
                <div class="text-lg">Pok√©mon Guessed: ${currentPokemonIndex + 1}</div>
                <div class="text-sm text-gray-300">Total Guesses: ${totalGuesses}</div>
                <div class="text-sm text-gray-300">Skips: ${totalSkips}</div>
            </div>
        `;
    }
    
    // Hide hints on results screen
    document.getElementById('hints').style.display = 'none';
    
    guessButton.classList.add('hidden');
    nextButton.classList.add('hidden');
    skipButton.classList.add('hidden');
    previousButton.classList.add('hidden');
    restartButton.classList.remove('hidden');
    pokemonSprite.style.display = 'none';
    if (myChart) myChart.destroy();
}

// Scoring functions for daily challenge
function calculateScore() {
    const maxScore = 1000;
    const perfectGuesses = pokemonQueue.length;
    const guessPenalty = Math.max(0, totalGuesses - perfectGuesses) * 50;
    const skipPenalty = totalSkips * 150;
    const score = Math.max(0, maxScore - guessPenalty - skipPenalty);
    return score;
}

function generateShareText(score) {
    const today = new Date().toLocaleDateString();
    const efficiency = Math.round((pokemonQueue.length / totalGuesses) * 100);
    
    return `üéÆ BST Guesser Daily Challenge - ${today}
üéØ Score: ${score}/1000
üìä Guesses: ${totalGuesses}/${pokemonQueue.length * 3} (${efficiency}% efficiency)
‚è≠Ô∏è Skips: ${totalSkips}
üèÜ ${getScoreRank(score)}

Can you beat my score? Play at: ${window.location.href}`;
}

function getScoreRank(score) {
    if (score >= 950) return "Pok√©mon Master! ü•á";
    if (score >= 850) return "Expert Trainer! ü•à";
    if (score >= 700) return "Skilled Trainer! ü•â";
    if (score >= 500) return "Novice Trainer üìö";
    return "Keep Training! üí™";
}

async function copyToClipboard(text) {
    try {
        await navigator.clipboard.writeText(text);
        return true;
    } catch (err) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        return true;
    }
}

// Return Function
function returnToMenu() {
    gameScreen.classList.add('hidden');
    loadingScreen.classList.add('hidden');
    homeMenu.classList.remove('hidden');
    if (myChart) myChart.destroy();
    pokemonSprite.style.display = 'block';
    
    // Remove share button if it exists
    const shareButton = document.getElementById('shareResultsButton');
    if (shareButton) {
        shareButton.remove();
    }
}

// New function to get Pokemon data with caching
async function getPokemon(id) {
    const cached = localStorage.getItem('pokemon_' + id);
    if (cached) return JSON.parse(cached);
    const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
    const data = await response.json();
    localStorage.setItem('pokemon_' + id, JSON.stringify(data));
    return data;
}

// Initialize the app
document.addEventListener('DOMContentLoaded', function() {
    initializeAutocomplete();
    
    // Language selector event listener
    const languageSelect = document.getElementById('languageSelect');
    if (languageSelect) {
        languageSelect.addEventListener('change', function() {
            currentLanguage = this.value;
            updateLanguage();
            
            // Save language preference
            localStorage.setItem('bstGuesserLanguage', currentLanguage);
        });
        
        // Load saved language preference
        const savedLanguage = localStorage.getItem('bstGuesserLanguage');
        if (savedLanguage && translations[savedLanguage]) {
            currentLanguage = savedLanguage;
            languageSelect.value = currentLanguage;
            updateLanguage();
        }
    }
    
    // Register Chart.js plugin
    if (typeof ChartDataLabels !== 'undefined') {
        Chart.register(ChartDataLabels);
    }
});
    </script>
    
    <footer class="w-full bg-gradient-to-r from-blue-900 to-indigo-900 py-6 mt-8 border-t-4 border-blue-400">
    <div class="max-w-4xl mx-auto px-4">
        <!-- Social Media and Links Section -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-6">
            <div class="flex items-center space-x-4 mb-4 md:mb-0">
                <img src="./4408299.png" alt="BST Guesser Logo" class="w-8 h-8 object-contain">
                <span class="text-white font-bold text-lg">BST Guesser</span>
                
                <!-- Language Selector -->
                <div class="flex items-center space-x-2 ml-4">
                    <label for="languageSelect" class="text-blue-200 text-sm font-medium">Language:</label>
                    <select id="languageSelect" class="bg-blue-700 border border-blue-500 text-white text-sm rounded px-2 py-1 focus:ring-2 focus:ring-blue-400 focus:border-transparent">
                        <option value="en" class="bg-blue-700 text-white">EN</option>
                        <option value="fr" class="bg-blue-700 text-white">FR (soon)</option>
                    </select>
                </div>
            </div>
            
            <!-- Social Media Buttons -->
            <div class="flex items-center space-x-3">
                <a href="https://x.com/Oquinn_mb" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full transition-all duration-200 transform hover:scale-105 shadow-lg"
                   title="Follow on Twitter/X">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                    </svg>
                </a>
                
                <!-- Buy Me a Coffee link -->
                <a href="https://buymeacoffee.com/oakwin" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="bg-orange-600 hover:bg-orange-700 text-white p-3 rounded-full transition-all duration-200 transform hover:scale-105 shadow-lg"
                   title="Buy me a coffee">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M7.5 10.5C7.5 9.67 8.17 9 9 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5zM12 9c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5S12.83 9 12 9zM15 9c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5S15.83 9 15 9z"/>
                        <path d="M20 3H4v10c0 2.21 1.79 4 4 4h6c2.21 0 4-1.79 4-4v-3h2c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zm-2 10c0 1.1-.9 2-2 2H8c-1.1 0-2-.9-2-2V5h12v8zm2-5h-2V6h2v2z"/>
                    </svg>
                </a>
                
                <!-- GitHub link -->
                <a href="https://github.com/d-garfield" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="bg-gray-700 hover:bg-gray-600 text-white p-3 rounded-full transition-all duration-200 transform hover:scale-105 shadow-lg"
                   title="View on GitHub">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.30.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                </a>
            </div>
        </div>
        
        <!-- Rest of the existing footer content -->
        <div class="border-t border-blue-400 pt-4 flex flex-col md:flex-row md:justify-between md:items-start">
    <div class="md:w-2/3">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <button id="privacyBtn" class="bg-blue-800 bg-opacity-50 rounded-lg p-4 backdrop-blur-sm w-full text-left font-semibold text-blue-100 hover:text-white transition-colors cursor-pointer">
                üîí Privacy Policy
            </button>
            <button id="termsBtn" class="bg-blue-800 bg-opacity-50 rounded-lg p-4 backdrop-blur-sm w-full text-left font-semibold text-blue-100 hover:text-white transition-colors cursor-pointer">
                üìã Terms of Service
            </button>
        </div>
        <!-- Copyright and Credits -->
        <div class="text-center text-blue-300 text-sm">
            <p class="mb-2">
                Made with ‚ù§Ô∏è by and for Pok√©mon fans | Data powered by 
                <a href="https://pokeapi.co" target="_blank" class="text-blue-400 hover:text-white underline transition-colors">Pok√©API</a>
            </p>
            <p>&copy; 2025 BST Guesser - All rights reserved</p>
        </div>
    </div>
    <div class="md:w-1/3 md:pl-8 flex justify-end mt-6 md:mt-0">
        <div id="devUpdates" style="
            background: rgba(30, 58, 138, 0.95);
            color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.25);
            padding: 16px 20px;
            min-width: 220px;
            max-width: 320px;
            font-size: 0.95rem;
            font-family: 'Inter', sans-serif;
        ">
            <div style="font-weight: bold; margin-bottom: 6px; font-size: 1.05rem;">
                Developer Updates
            </div>
            <div id="devUpdatesList">
                <!-- Updates will appear here -->
            </div>
        </div>
    </div>
</div>
<script>
const updates = [
    { text: "Mobile loading bug being worked on.", time: "8/4/2025" },
    // Just add more updates after fixing things :)
];

function loadDevUpdates() {
    devUpdatesList.innerHTML = updates.map(u => 
        `<div style="margin-bottom:6px;">
            <span style="color:#93c5fd;">${u.time}</span>: ${u.text}
        </div>`
    ).join('');
}
const devUpdatesList = document.getElementById('devUpdatesList');
loadDevUpdates();
</script>

<!-- Privacy Policy Modal -->
<div id="privacyModal" style="display:none; position:fixed; z-index:100; left:0; top:0; width:100vw; height:100vh; background:rgba(30,41,59,0.7); align-items:center; justify-content:center;">
    <div style="background:#1e293b; color:#fff; border-radius:12px; box-shadow:0 4px 24px rgba(0,0,0,0.4); padding:32px 24px 24px 24px; max-width:400px; width:90vw; margin:auto; position:relative;">
        <button id="closePrivacyModal" style="position:absolute; top:12px; right:12px; background:transparent; border:none; color:#fff; font-size:1.5rem; cursor:pointer;" title="Close">&times;</button>
        <h2 style="font-size:1.25rem; font-weight:bold; margin-bottom:12px;">Privacy Policy</h2>
        <p class="mt-3 text-blue-200 text-sm leading-relaxed">
            This website does not collect personal information. Third-party services (such as ad networks) may use cookies for analytics and advertising. All Pok√©mon data is sourced from Pok√©API.<br>
            <strong>Note:</strong> For performance, this site may cache Pok√©mon data in your browser using localStorage. This data is only stored on your device and is not sent to the server.
        </p>
    </div>
</div>

<!-- Terms of Service Modal -->
<div id="termsModal" style="display:none; position:fixed; z-index:100; left:0; top:0; width:100vw; height:100vh; background:rgba(30,41,59,0.7); align-items:center; justify-content:center;">
    <div style="background:#1e293b; color:#fff; border-radius:12px; box-shadow:0 4px 24px rgba(0,0,0,0.4); padding:32px 24px 24px 24px; max-width:400px; width:90vw; margin:auto; position:relative;">
        <button id="closeTermsModal" style="position:absolute; top:12px; right:12px; background:transparent; border:none; color:#fff; font-size:1.5rem; cursor:pointer;" title="Close">&times;</button>
        <h2 style="font-size:1.25rem; font-weight:bold; margin-bottom:12px;">Terms of Service</h2>
        <p class="mt-3 text-blue-200 text-sm leading-relaxed">
            By using this site, you agree to use it for entertainment purposes only. All Pok√©mon data is provided by the Pok√©API and is for non-commercial use. Pok√©mon ¬© Nintendo/Game Freak.
        </p>
    </div>
</div>

<script>
// Modal logic for Privacy Policy
const privacyBtn = document.getElementById('privacyBtn');
const privacyModal = document.getElementById('privacyModal');
const closePrivacyModal = document.getElementById('closePrivacyModal');
privacyBtn.onclick = () => { privacyModal.style.display = 'flex'; };
closePrivacyModal.onclick = () => { privacyModal.style.display = 'none'; };
privacyModal.onclick = (e) => { if (e.target === privacyModal) closePrivacyModal.onclick(); };

// Modal logic for Terms of Service
const termsBtn = document.getElementById('termsBtn');
const termsModal = document.getElementById('termsModal');
const closeTermsModal = document.getElementById('closeTermsModal');
termsBtn.onclick = () => { termsModal.style.display = 'flex'; };
closeTermsModal.onclick = () => { termsModal.style.display = 'none'; };
termsModal.onclick = (e) => { if (e.target === termsModal) closeTermsModal.onclick(); };
</script>
<!-- filepath: c:\Users\Derek\Code-repository\BSTGuesser\d-garfield.github.io\index.html -->

